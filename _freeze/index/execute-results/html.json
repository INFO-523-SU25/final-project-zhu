{
  "hash": "c4f9f1309fadc6da0db38eca33a8968e",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Forecasting Anomalies in AtHub’s Stock Behavior\"\nsubtitle: \"INFO 523 - Final Project\"\nauthor: \n  - name: \"Annabelle Zhu\"\n    affiliations:\n      - name: \"College of Information Science, University of Arizona\"\ndescription: \"Project description\"\nformat:\n   html:\n    code-tools: true\n    code-overflow: wrap\n    embed-resources: true\neditor: visual\nexecute:\n  warning: false\n  echo: false\njupyter: python3\n---\n\n# Abstract\n\nThis project investigates whether abnormal price and volume fluctuations in AtHub (603881.SH)—a Chinese data center infrastructure firm—can be predicted using technical analysis (TA) features. We define volatility anomalies as daily returns exceeding ±5% or volume surges exceeding twice the 30-day rolling average. Drawing on over 30 engineered TA indicators spanning momentum, trend, volume, and volatility categories, we construct a supervised learning pipeline to forecast next-day anomalies. The model is evaluated using time-aware cross-validation and interpreted through SHAP analysis to reveal leading patterns and feature contributions. Results suggest that certain TA combinations (e.g., high RSI with declining OBV) consistently precede large movements, demonstrating the potential of interpretable, data-driven tools for anomaly detection in high-volatility equities.\n\n------------------------------------------------------------------------\n\n# Introduction\n\nPredicting sudden shifts in equity price or trading volume is a long-standing challenge in financial forecasting, particularly for high-volatility stocks sensitive to external shocks. This project centers on AtHub (603881.SH), a stock known for its erratic short-term behavior and policy-driven sensitivity, to assess whether machine learning models can detect early signs of abnormal market activity. Unlike traditional models that aim to forecast precise price levels, our approach reframes the task as a binary classification problem focused on identifying rare but impactful events. We rely exclusively on market-based features—technical indicators derived from historical prices and volumes—to build a predictive framework that aligns with real-world constraints where external signals (e.g., news sentiment, fundamentals) may be unavailable or delayed. By integrating explainable AI methods into the model workflow, this project also emphasizes transparency and trustworthiness in financial ML applications.\n\n------------------------------------------------------------------------\n\n# Reasearch Questions\n\n-   Q1. Can TA features detect anomalies 1–3 days in advance? Which indicators lead?\n\n-   Q2. Which features drive predictions? Do they align with financial theory?\n\n-   Q3. How do anomaly thresholds ($\\pm$ 3% vs. $\\pm$ 5% vs. $\\pm$ 7% price; 1.8 $\\times$ vs. 2.5$\\times$ volume) impact model performance?\n\n------------------------------------------------------------------------\n\n# Exploratory Analysis\n\n## Loading and Initial Preparation\n\n\n\n\n\n::: {#3e5c9029 .cell execution_count=3}\n\n::: {.cell-output .cell-output-stdout}\n```\nTotal observations: 375\nNumber of Columns: 31\n```\n:::\n:::\n\n\n## Target Variable Engineering\n\n### Define the binary target: will there be an anomaly tomorrow?\n\n\n\nTo better understand the imbalance in the target variable, we plot the proportion of anomaly vs. normal days. An anomaly day is defined as either a $\\pm$ 5% price change or a volume spike above twice the 30-day moving average. The bar chart highlights the class imbalance, a common challenge in financial anomaly detection.\n\n::: {#cell-target-distribution-bar .cell comment='Bar plot showing the proportion of anomaly vs. normal days in the dataset.' execution_count=5}\n\n::: {.cell-output .cell-output-display}\n![Class Distribution of Target Labels](index_files/figure-html/target-distribution-bar-output-1.png){#target-distribution-bar}\n:::\n:::\n\n\n### Data-cleaning\n\n::: {#d8e555a6 .cell execution_count=6}\n\n::: {.cell-output .cell-output-stdout}\n```\nMissing values per column:\nts_code               0\nopen                  0\nhigh                  0\nlow                   0\nclose                 0\npct_chg               0\nvol                   0\namount                0\nvolume_obv            0\nvolume_cmf            0\nvolume_vpt            0\nvolume_vwap           0\nvolume_mfi            0\nvolatility_bbw        0\nvolatility_atr        0\nvolatility_ui         0\ntrend_macd            0\ntrend_macd_signal     0\ntrend_macd_diff       0\ntrend_adx             0\ntrend_adx_pos         0\ntrend_adx_neg         0\nmomentum_rsi          0\nmomentum_wr           0\nmomentum_roc          0\nmomentum_ao           0\nmomentum_ppo_hist     0\ntrend_cci             0\ntrend_aroon_up        0\ntrend_aroon_down      0\ntrend_aroon_ind       0\nvol_ma30             29\nanomaly               0\ntarget                0\ndtype: int64\n```\n:::\n:::\n\n\n\n\n### Data Reduction\n\n#### Remove unnecessary columns\n\n::: {#7bbcf7fe .cell execution_count=8}\n\n::: {.cell-output .cell-output-stdout}\n```\nRemaining features: 30\n```\n:::\n:::\n\n\n#### Correlation Analysis\n\n::: {#cell-correlation-analysis .cell execution_count=9}\n\n::: {.cell-output .cell-output-display}\n![Correlation Matrix of Selected Features](index_files/figure-html/correlation-analysis-output-1.png){#correlation-analysis}\n:::\n:::\n\n\n> There is no highly correlated features\n\n### Data-Transformation\n\n::: {#be06f757 .cell execution_count=10}\n\n::: {.cell-output .cell-output-stdout}\n```\nFeature skewness before transformation:\nvol           2.260647\namount        2.817781\nvolume_obv    2.174151\nvolume_vpt    0.949351\ndtype: float64\n```\n:::\n:::\n\n\n> We can see from the output, `vol`, `amount`, `volume_obv` is highly right skewed, and `volume_vpt` is a little right skewed. We can apply log transformation.\n\n\n\n### Feature Engineering\n\n#### Creating Lag Features\n\nTo capture predictive patterns leading up to volatility events, we create lagged versions of key indicators. This allows the model to detect precursor signals 1-3 days before anomalies.\n\n\n\n> These lagged features serve as candidate leading indicators, designed to capture anomaly signals up to 3 days ahead of their occurrence.\n\n\n\n#### Creating Rolling Statistics\n\n\n\n> Rolling window statistics help capture evolving market conditions and short-term trends that may precede volatility events.\n\n#### Interaction Features\n\nWe create interaction terms between key indicators that financial theory suggests may combine to signal impending volatility.\n\n\n\n### Feature Importance\n\n**We use mutual information to identify the most predictive features for our anomaly target.**\n\n\n\n::: {#5eb9c733 .cell execution_count=16}\n\n::: {.cell-output .cell-output-stdout}\n```\nTop 20 features by mutual information:\n['log_amount', 'log_vol', 'high', 'volume_vwap', 'open', 'low', 'volatility_atr_lag1', 'trend_macd', 'volatility_atr', 'log_volume_vpt_ma5', 'volatility_atr_ma10', 'volatility_atr_lag2', 'close', 'trend_cci', 'volatility_atr_lag3', 'momentum_rsi_lag2', 'volatility_ui', 'rsi_vol_interaction', 'log_volume_vpt', 'pct_chg']\n```\n:::\n:::\n\n\n::: {#f99abf06 .cell execution_count=17}\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-18-output-1.png){}\n:::\n:::\n\n\n------------------------------------------------------------------------\n\n# Data Prepossessing\n\n",
    "supporting": [
      "index_files\\figure-html"
    ],
    "filters": [],
    "includes": {}
  }
}